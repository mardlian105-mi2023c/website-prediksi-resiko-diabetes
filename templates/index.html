<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sistem Prediksi Risiko Diabetes (Akurasi 91%)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/styles.css') }}"
    />
    <script
      src="{{ url_for('static', filename='js/script.js') }}"
      defer
    ></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#0f172a",
              secondary: "#0891b2",
              accent: "#4f46e5",
            },
            fontFamily: {
              heading: ["Poppins", "sans-serif"],
            },
          },
        },
      };
    </script>
  </head>

  <body class=>
    <nav class="bg-blue-600 shadow-md">
      <div
        class="container mx-auto px-4 py-3 flex justify-between items-center"
      >
        <h1 class="text-white font-semibold text-lg">Diabetes Prediction</h1>

        <ul class="flex space-x-6">
          <li>
            <a
              href="{{ url_for('index') }}"
              class="text-white hover:text-gray-200 transition"
            >
              Dashboard
            </a>
          </li>
          <li>
            <a
              href="{{ url_for('predict') }}"
              class="text-white hover:text-gray-200 transition"
            >
              Prediksi Individu
            </a>
          </li>
          <li>
            <a
              href="{{ url_for('predict_file') }}"
              class="text-white hover:text-gray-200 transition"
            >
              Prediksi CSV
            </a>
          </li>
        </ul>
      </div>
    </nav>

    <!-- Floating decorative elements -->
    <div class="floating-element top-10 left-5 bg-purple-300"></div>
    <div class="floating-element top-1/4 right-10 bg-indigo-300 delay-1s"></div>
    <div
      class="floating-element bottom-1/3 left-1/4 bg-pink-300 delay-2s"
    ></div>

    <div class="max-w-7xl mx-auto">
      <!-- Header Section -->
      <div class="glass-effect rounded-2xl p-6 mb-8 shadow-xl">
        <div class="flex flex-col md:flex-row items-center justify-between">
          <div class="mb-6 md:mb-0">
            <div class="flex items-center">
              <div
                class="p-3 rounded-xl bg-gradient-to-br from-purple-100 to-indigo-100 mr-4"
              >
                <i class="fas fa-heartbeat text-2xl text-accent"></i>
              </div>
              <div>
                <h1
                  class="text-3xl sm:text-4xl font-bold text-gray-900 font-heading"
                >
                  Sistem Prediksi Risiko Diabetes
                </h1>
                <div class="flex items-center mt-2">
                  <p class="text-gray-600">Model CatBoost terintegrasi</p>
                  <div class="badge-accent">
                    <i class="fas fa-bolt mr-1"></i> Prediksi Cepat
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div
            class="bg-gradient-to-r from-purple-50 to-indigo-50 p-4 rounded-xl border border-purple-100"
          >
            <p class="text-sm text-gray-700">
              <i class="fas fa-clock text-purple-500 mr-2"></i>
              Prediksi instan dalam 1 menit
            </p>
            <p class="text-sm text-gray-700 mt-1">
              <i class="fas fa-shield-alt text-indigo-500 mr-2"></i>
              Data Anda aman & terjaga
            </p>
          </div>
        </div>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
        <!-- Left Panel - Instructions -->
        <div class="lg:col-span-1">
          <div class="glass-effect rounded-2xl p-6 sticky top-8 card-hover">
            <h3 class="text-xl font-bold text-gray-900 mb-4 flex items-center">
              <i class="fas fa-info-circle text-accent mr-3"></i>
              Petunjuk Pengisian
            </h3>

            <div class="space-y-4">
              <div class="bg-white p-4 rounded-lg border border-gray-100">
                <div class="flex items-start">
                  <div class="p-2 rounded-lg bg-blue-50 mr-3">
                    <i class="fas fa-flask text-blue-500"></i>
                  </div>
                  <div>
                    <h4 class="font-semibold text-gray-800">Data Klinis</h4>
                    <p class="text-sm text-gray-600 mt-1">
                      Masukkan angka berdasarkan hasil tes laboratorium terkini
                      Anda.
                    </p>
                  </div>
                </div>
              </div>

              <div class="bg-white p-4 rounded-lg border border-gray-100">
                <div class="flex items-start">
                  <div class="p-2 rounded-lg bg-green-50 mr-3">
                    <i class="fas fa-history text-green-500"></i>
                  </div>
                  <div>
                    <h4 class="font-semibold text-gray-800">Faktor Riwayat</h4>
                    <p class="text-sm text-gray-600 mt-1">
                      Masukkan <span class="font-bold">1</span> jika ada
                      riwayat, <span class="font-bold">0</span> jika tidak ada.
                    </p>
                  </div>
                </div>
              </div>

              <div class="bg-white p-4 rounded-lg border border-gray-100">
                <div class="flex items-start">
                  <div class="p-2 rounded-lg bg-purple-50 mr-3">
                    <i class="fas fa-chart-line text-purple-500"></i>
                  </div>
                  <div>
                    <h4 class="font-semibold text-gray-800">
                      HbA1c & Diet Score
                    </h4>
                    <p class="text-sm text-gray-600 mt-1">
                      Nilai HbA1c dalam persen, Diet Score dari 1 (buruk) hingga
                      10 (sangat sehat).
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <div class="mt-6 pt-6 border-t border-gray-100">
              <p class="text-sm text-gray-600 flex items-center">
                <i class="fas fa-lightbulb text-yellow-500 mr-2"></i>
                Pastikan semua data diisi dengan akurat untuk hasil prediksi
                optimal.
              </p>
            </div>
          </div>
        </div>

        <!-- Main Content - Form -->
        <div class="lg:col-span-3">
          <div class="glass-effect rounded-2xl p-6 shadow-xl">
            {% if result and result.status == 'Error' %}
            <div class="error-alert" role="alert">
              <div class="flex items-center">
                <div class="p-2 rounded-full bg-red-100 mr-4">
                  <i class="fas fa-exclamation-triangle text-red-600"></i>
                </div>
                <div>
                  <h4 class="font-bold text-gray-900">KESALAHAN INPUT DATA</h4>
                  <p class="text-sm text-gray-700 mt-1">{{ result.pesan }}</p>
                </div>
              </div>
            </div>
            {% endif %}

            <form method="POST" id="predictionForm">
              <!-- Section 1: Demografi & Gaya Hidup -->
              <div class="mb-10">
                <div class="flex items-center mb-6">
                  <div
                    class="section-icon bg-gradient-to-r from-blue-500 to-indigo-500"
                  >
                    <i class="fas fa-user text-white"></i>
                  </div>
                  <h2 class="text-2xl font-bold text-gray-900">
                    Data Demografi & Gaya Hidup
                  </h2>
                </div>

                <div
                  class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
                >
                  {% set demo_fields = [ ('Age', 'Tahun', 'number', 'e.g., 45',
                  'fas fa-birthday-cake'), ('gender', '', 'select', '', 'fas
                  fa-venus-mars'), ('ethnicity', '', 'select', '', 'fas
                  fa-globe-asia'), ('education_level', '', 'select', '', 'fas
                  fa-graduation-cap'), ('income_level', '', 'select', '', 'fas
                  fa-money-bill-wave'), ('employment_status', '', 'select', '',
                  'fas fa-briefcase'), ('smoking_status', '', 'select', '', 'fas
                  fa-smoking'), ('alcohol_consumption_per_week', 'Times/Week',
                  'number', 'e.g., 0', 'fas fa-wine-glass'),
                  ('physical_activity_minutes_per_week', 'Minutes/Week',
                  'number', 'e.g., 150', 'fas fa-running') ] %} {% for field,
                  label, type, placeholder, icon in demo_fields %}
                  <div class="input-group">
                    <label class="input-label" for="{{ field }}">
                      <i class="{{ icon }} text-blue-500 mr-2"></i>
                      {{ field.replace('_', ' ').title() }}{% if label %} ({{
                      label }}){% endif %}:
                    </label>
                    {% if type == 'select' %}
                    <select
                      name="{{ field }}"
                      id="{{ field }}"
                      required
                      class="input-field select-elegant"
                    >
                      {% if field == 'gender' %}
                      <option value="Male">Male</option>
                      <option value="Female">Female</option>
                      {% elif field == 'ethnicity' %}
                      <option value="White">White</option>
                      <option value="Asian">Asian</option>
                      <option value="Black">Black</option>
                      <option value="Hispanic">Hispanic</option>
                      {% elif field == 'education_level' %}
                      <option value="Graduate">Graduate</option>
                      <option value="Highschool">Highschool</option>
                      <option value="Doctorate">Doctorate</option>
                      <option value="Primary School">Primary School</option>
                      {% elif field == 'income_level' %}
                      <option value="Middle">Middle</option>
                      <option value="Lower-Middle">Lower-Middle</option>
                      <option value="High">High</option>
                      <option value="Low">Low</option>
                      {% elif field == 'employment_status' %}
                      <option value="Employed">Employed</option>
                      <option value="Unemployed">Unemployed</option>
                      <option value="Retired">Retired</option>
                      <option value="Student">Student</option>
                      {% elif field == 'smoking_status' %}
                      <option value="Never">Never</option>
                      <option value="Former">Former</option>
                      <option value="Current">Current</option>
                      {% endif %}
                    </select>
                    {% else %}
                    <input
                      type="{{ type }}"
                      step="1"
                      name="{{ field }}"
                      id="{{ field }}"
                      required
                      class="input-field"
                      placeholder="{{ placeholder }}"
                    />
                    {% endif %}
                  </div>
                  {% endfor %}
                </div>
              </div>

              <!-- Section 2: Gaya Hidup & Riwayat Klinis -->
              <div class="mb-10">
                <div class="section-divider"></div>
                <div class="flex items-center mb-6">
                  <div
                    class="section-icon bg-gradient-to-r from-green-500 to-emerald-500"
                  >
                    <i class="fas fa-heartbeat text-white"></i>
                  </div>
                  <h2 class="text-2xl font-bold text-gray-900">
                    Gaya Hidup & Riwayat Klinis
                  </h2>
                </div>

                <div
                  class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
                >
                  {% set lifestyle_fields = [ ('diet_score', '1-10', 'number',
                  'e.g., 7.5', 'fas fa-utensils'), ('sleep_hours_per_day',
                  'Hours/Day', 'number', 'e.g., 7.0', 'fas fa-bed'),
                  ('screen_time_hours_per_day', 'Hours/Day', 'number', 'e.g.,
                  3.5', 'fas fa-desktop'), ('family_history_diabetes', '0: No,
                  1: Yes', 'number', '0 or 1', 'fas fa-dna'),
                  ('hypertension_history', '0: No, 1: Yes', 'number', '0 or 1',
                  'fas fa-tint'), ('cardiovascular_history', '0: No, 1: Yes',
                  'number', '0 or 1', 'fas fa-heart'), ('bmi', '', 'number',
                  'e.g., 24.5', 'fas fa-weight'), ('waist_to_hip_ratio', '',
                  'number', 'e.g., 0.85', 'fas fa-ruler-combined'),
                  ('systolic_bp', 'mm/Hg', 'number', 'e.g., 120', 'fas
                  fa-heartbeat'), ('diastolic_bp', 'mm/Hg', 'number', 'e.g.,
                  80', 'fas fa-heartbeat') ] %} {% for field, label, type,
                  placeholder, icon in lifestyle_fields %}
                  <div class="input-group">
                    <label class="input-label" for="{{ field }}">
                      <i class="{{ icon }} text-green-500 mr-2"></i>
                      {{ field.replace('_', ' ').title() }}{% if label %} ({{
                      label }}){% endif %}:
                    </label>
                    <input type="{{ type }}" {% if field in ['diet_score',
                    'sleep_hours_per_day', 'screen_time_hours_per_day']
                    %}step="0.1" {% elif field == 'waist_to_hip_ratio'
                    %}step="0.01" {% else %}step="1"{% endif %} name="{{ field
                    }}" id="{{ field }}" required class="input-field"
                    placeholder="{{ placeholder }}">
                  </div>
                  {% endfor %}
                </div>
              </div>

              <!-- Section 3: Hasil Laboratorium -->
              <div class="mb-10">
                <div class="section-divider"></div>
                <div class="flex items-center mb-6">
                  <div
                    class="section-icon bg-gradient-to-r from-purple-500 to-pink-500"
                  >
                    <i class="fas fa-vial text-white"></i>
                  </div>
                  <h2 class="text-2xl font-bold text-gray-900">
                    Hasil Laboratorium (Biomarker)
                  </h2>
                </div>

                <div
                  class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
                >
                  {% set lab_fields = [ ('heart_rate', 'BPM', 'number', 'e.g.,
                  72', 'fas fa-heart'), ('cholesterol_total', 'mg/dL', 'number',
                  'e.g., 180', 'fas fa-vial'), ('hdl_cholesterol', 'mg/dL',
                  'number', 'e.g., 55', 'fas fa-vial'), ('ldl_cholesterol',
                  'mg/dL', 'number', 'e.g., 100', 'fas fa-vial'),
                  ('triglycerides', 'mg/dL', 'number', 'e.g., 120', 'fas
                  fa-vial'), ('glucose_fasting', 'mg/dL', 'number', 'e.g., 95',
                  'fas fa-syringe'), ('glucose_postprandial', 'mg/dL', 'number',
                  'e.g., 130', 'fas fa-syringe'), ('insulin_level', 'mIU/L',
                  'number', 'e.g., 5.5', 'fas fa-prescription-bottle'),
                  ('hba1c', '%', 'number', 'e.g., 5.4', 'fas fa-chart-line') ]
                  %} {% for field, label, type, placeholder, icon in lab_fields
                  %}
                  <div class="input-group">
                    <label class="input-label" for="{{ field }}">
                      <i class="{{ icon }} text-purple-500 mr-2"></i>
                      {{ field.replace('_', ' ').title() }}{% if label %} ({{
                      label }}){% endif %}:
                    </label>
                    <input type="{{ type }}" {% if field == 'insulin_level'
                    %}step="0.01" {% elif field == 'hba1c' %}step="0.01" {% else
                    %}step="1"{% endif %} name="{{ field }}" id="{{ field }}"
                    required class="input-field" placeholder="{{ placeholder
                    }}">
                  </div>
                  {% endfor %}
                </div>
              </div>

              <!-- Submit Button -->
              <div class="mt-10 pt-8 border-t border-gray-200">
                <button type="submit" class="submit-button pulse-animation">
                  <i class="fas fa-bolt mr-3"></i>
                  PREDIKSI TAHAP RISIKO DIABETES
                  <i class="fas fa-arrow-right ml-3"></i>
                </button>
                <p class="text-center text-gray-500 text-sm mt-3">
                  <i class="fas fa-lock mr-2"></i>
                  Data Anda diproses secara aman dan tidak disimpan
                </p>
              </div>
            </form>

            <!-- Results Section -->
            {% if result and result.status == 'Prediksi Berhasil' %}
            <div class="mt-10 result-card rounded-2xl p-8 shadow-2xl">
              <div class="text-center mb-6">
                <div class="result-icon">
                  {% if result.tahap == 'No Diabetes' %}
                  <i class="fas fa-check-circle text-3xl text-green-500"></i>
                  {% elif result.tahap == 'Pre-Diabetes' %}
                  <i
                    class="fas fa-exclamation-triangle text-3xl text-yellow-500"
                  ></i>
                  {% elif result.tahap == 'Type 2' %}
                  <i
                    class="fas fa-exclamation-circle text-3xl text-red-500"
                  ></i>
                  {% endif %}
                </div>

                <h2 class="text-3xl font-bold text-gray-900 mb-2">
                  {% if result.tahap == 'No Diabetes' %} üéâ Prediksi Risiko
                  Rendah {% elif result.tahap == 'Pre-Diabetes' %} ‚ö†Ô∏è Prediksi
                  Risiko Sedang {% elif result.tahap == 'Type 2' %} üö® Prediksi
                  Risiko Tinggi {% endif %}
                </h2>

                <p class="text-gray-600">
                  Tahap Risiko Diabetes Anda diprediksi sebagai:
                </p>
              </div>

              <div class="text-center mb-8">
                <div
                  class="result-stage {% if result.tahap == 'No Diabetes' %}result-stage-low {% elif result.tahap == 'Pre-Diabetes' %}result-stage-medium {% elif result.tahap == 'Type 2' %}result-stage-high{% endif %}"
                >
                  <h3
                    class="result-stage-text {% if result.tahap == 'No Diabetes' %}text-green-700 {% elif result.tahap == 'Pre-Diabetes' %}text-yellow-700 {% elif result.tahap == 'Type 2' %}text-red-700{% endif %}"
                  >
                    {{ result.tahap }}
                  </h3>
                </div>

                <div class="mt-6">
                  <div class="confidence-badge">
                    <i class="fas fa-chart-bar mr-3 text-purple-500"></i>
                    <span class="font-semibold text-gray-700"
                      >Tingkat Keyakinan Model:</span
                    >
                    <span class="confidence-value"
                      >{{ result.persen_risiko }}</span
                    >
                  </div>
                </div>
              </div>

              {% if result.tahap == 'Type 2' %}
              <div class="result-recommendation result-recommendation-high">
                <div class="flex items-start">
                  <div class="recommendation-icon">
                    <i class="fas fa-exclamation text-red-600"></i>
                  </div>
                  <div>
                    <h4 class="font-bold text-gray-900">Rekomendasi Penting</h4>
                    <p class="text-gray-700 mt-2">
                      Tingkat risiko tinggi memerlukan konsultasi segera dengan
                      profesional kesehatan. Segera buat janji temu dengan
                      dokter spesialis penyakit dalam atau endokrinologi.
                    </p>
                  </div>
                </div>
              </div>
              {% elif result.tahap == 'Pre-Diabetes' %}
              <div class="result-recommendation result-recommendation-medium">
                <div class="flex items-start">
                  <div class="recommendation-icon">
                    <i class="fas fa-lightbulb text-yellow-600"></i>
                  </div>
                  <div>
                    <h4 class="font-bold text-gray-900">Saran Tindak Lanjut</h4>
                    <p class="text-gray-700 mt-2">
                      Disarankan untuk melakukan perubahan gaya hidup drastis,
                      pemantauan berkala, dan konsultasi dengan ahli gizi untuk
                      penyesuaian pola makan.
                    </p>
                  </div>
                </div>
              </div>
              {% else %}
              <div class="result-recommendation result-recommendation-low">
                <div class="flex items-start">
                  <div class="recommendation-icon">
                    <i class="fas fa-check text-green-600"></i>
                  </div>
                  <div>
                    <h4 class="font-bold text-gray-900">Status Baik</h4>
                    <p class="text-gray-700 mt-2">
                      Pertahankan gaya hidup sehat dan lakukan pemeriksaan rutin
                      tahunan untuk memantau kondisi kesehatan Anda.
                    </p>
                  </div>
                </div>
              </div>
              {% endif %}

              <div class="mt-8 text-center">
                <button
                  onclick="window.location.reload()"
                  class="new-prediction-btn"
                >
                  <i class="fas fa-redo mr-2"></i>
                  Lakukan Prediksi Baru
                </button>
              </div>
            </div>
            {% endif %}
          </div>

          <!-- Footer Note -->
          <div class="mt-8 text-center text-gray-500 text-sm">
            <p>
              <i class="fas fa-shield-alt mr-2"></i>
              Sistem ini menggunakan model machine learning CatBoost dengan
              akurasi 91%. Hasil prediksi bukan diagnosis medis.
            </p>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
